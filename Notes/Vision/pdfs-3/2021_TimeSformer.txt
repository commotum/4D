                                                    Is Space-Time Attention All You Need for Video Understanding?


                                                                         Gedas Bertasius 1 Heng Wang 1 Lorenzo Torresani 1 2


                                                                 Abstract                                with NLP. First of all, videos and sentences are both sequen-
                                             We present a convolution-free approach to video             tial. Furthermore, precisely as the meaning of a word can
                                             classification built exclusively on self-attention          often be understood only by relating it to the other words in
                                             over space and time. Our method, named “TimeS-              the sentence, it may be argued that atomic actions in short-
arXiv:2102.05095v4 [cs.CV] 9 Jun 2021




                                             former,” adapts the standard Transformer archi-             term segments need to be contextualized with the rest of the
                                             tecture to video by enabling spatiotemporal fea-            video in order to be fully disambiguated. Thus, one would
                                             ture learning directly from a sequence of frame-            expect the long-range self-attention models from NLP to be
                                             level patches. Our experimental study com-                  highly effective for video modeling as well. However, in the
                                             pares different self-attention schemes and sug-             video domain, 2D or 3D convolutions still represent the core
                                             gests that “divided attention,” where temporal              operators for spatiotemporal feature learning across differ-
                                             attention and spatial attention are separately ap-          ent video tasks (Feichtenhofer et al., 2019a; Teed & Deng,
                                             plied within each block, leads to the best video            2020; Bertasius & Torresani, 2020). While self-attention
                                             classification accuracy among the design choices            has shown benefits when applied on top of convolutional
                                             considered. Despite the radically new design,               layers (Wang et al., 2018a), to the best of our knowledge, no
                                             TimeSformer achieves state-of-the-art results on            attempt to use self-attention as the exclusive building block
                                             several action recognition benchmarks, includ-              for video recognition models has been reported.
                                             ing the best reported accuracy on Kinetics-400              In this work we pose the question of whether it may be
                                             and Kinetics-600. Finally, compared to 3D                   possible to build a performant convolution-free video archi-
                                             convolutional networks, our model is faster to              tecture by replacing altogether the convolution operator with
                                             train, it can achieve dramatically higher test              self-attention. We argue that such a design has the poten-
                                             efficiency (at a small drop in accuracy), and               tial to overcome a few inherent limitations of convolutional
                                             it can also be applied to much longer video                 models for video analysis. First, while their strong inductive
                                             clips (over one minute long). Code and mod-                 biases (e.g., local connectivity and translation equivariance)
                                             els are available at: https://github.com/                   are undoubtedly beneficial on small training sets, they may
                                             facebookresearch/TimeSformer.                               excessively limit the expressivity of the model in settings
                                                                                                         where there is ample availability of data and “all” can be
                                                                                                         learned from examples. Compared to CNNs, Transformers
                                        1. Introduction                                                  impose less restrictive inductive biases. This broadens the
                                        Over the last few years, the field of natural language pro-      family of functions they can represent (Cordonnier et al.,
                                        cessing (NLP) has been revolutionized by the emergence of        2020; Zhao et al., 2020), and renders them better suited
                                        methods based on self-attention (Vaswani et al., 2017a). Be-     to modern big-data regimes where there is less need for
                                        cause of their excellent capabilities at capturing long-range    strong inductive priors. Second, while convolutional kernels
                                        dependencies among words as well as their training scala-        are specifically designed to capture short-range spatiotem-
                                        bility, self-attention architectures, such as the Transformer    poral information, they cannot model dependencies that
                                        model, represent the current state-of-the-art across a wide      extend beyond the receptive field. While deep stacks of
                                        range of language tasks, including machine translation (Ott      convolutions (Simonyan & Zisserman, 2015; Szegedy et al.,
                                        et al., 2018; Chen et al., 2018a), question answering (De-       2015; Carreira & Zisserman, 2017) naturally extend the
                                        vlin et al., 2019; Dai et al., 2019), and autoregressive word    receptive field, these strategies are inherently limited in cap-
                                        generation (Radford et al., 2019; Brown et al., 2020).           turing long-range dependencies by means of aggregation
                                                                                                         of shorter-range information. Conversely, the self-attention
                                        Video understanding shares several high-level similarities       mechanism can be applied to capture both local as well as
                                           1
                                             Facebook AI 2 Dartmouth College. Correspondence to: Gedas   global long-range dependencies by directly comparing fea-
                                        Bertasius <gberta@seas.upenn.edu>.                               ture activations at all space-time locations, much beyond the
                                                                                                         receptive field of traditional convolutional filters. Finally,
                               Is Space-Time Attention All You Need for Video Understanding?

despite the advances in GPU hardware acceleration, training      Our method is more closely related to image networks lever-
deep CNNs remains very costly, especially when applied to        aging self-attention as a substitute for convolution (Parmar
high-resolution and long videos. Recent work in the still-       et al., 2018; Ramachandran et al., 2019; Cordonnier et al.,
image domain (Dosovitskiy et al., 2020; Carion et al., 2020;     2020; Zhao et al., 2020). Since these works use individual
Zhao et al., 2020) has demonstrated that Transformers enjoy      pixels as queries, in order to maintain a manageable compu-
faster training and inference compared to CNNs, making it        tational cost and a small memory consumption, they must
possible to construct models with larger learning capacity       restrict the scope of self-attention to local neighborhoods or
for the same computational budget.                               use global self-attention on heavily downsized versions of
                                                                 the image. Alternative strategies for scalability to full im-
Motivated by these observations, we propose a video ar-
                                                                 ages include sparse key-value sampling (Child et al., 2019)
chitecture built exclusively on self-attention. We adapt the
                                                                 or constraining the self-attention to be calculated along the
image model “Vision Transformer” (ViT) (Dosovitskiy et al.,
                                                                 spatial axes (Ho et al., 2019; Huang et al., 2019; Wang
2020) to video by extending the self-attention mechanism
                                                                 et al., 2020b). A few of the self-attention operators con-
from the image space to the space-time 3D volume. Our
                                                                 sidered in our experiments adopt similar sparse and axial
proposed model, named “TimeSformer” (from Time-Space
                                                                 computation, although generalized to the spatiotemporal
Transformer), views the video as a sequence of patches ex-
                                                                 volume. However, the efficiency of our approach stems
tracted from the individual frames. As in ViT, each patch is
                                                                 mainly from decomposing the video into a sequence of
linearly mapped into an embedding and augmented with po-
                                                                 frame-level patches and then feeding linear embeddings of
sitional information. This makes it possible to interpret the
                                                                 these patches as input token embeddings to a Transformer.
resulting sequence of vectors as token embeddings which
                                                                 This strategy was recently introduced in Vision Transform-
can be fed to a Transformer encoder, analogously to the
                                                                 ers (ViT) (Dosovitskiy et al., 2020) which were shown to
token features computed from words in NLP.
                                                                 deliver impressive performance on image categorization. In
One downside of self-attention in standard Transformer is        this work, we build on the ViT design, and extend it to video
that it requires computing a similarity measure for all pairs    by proposing and empirically comparing several scalable
of tokens. In our setting, this is computationally costly due    schemes for space-time self-attention over videos.
to the large number of patches in the video. To address these
                                                                 While Transformers have been recently used for video gen-
challenges, we propose several scalable self-attention de-
                                                                 eration (Weissenborn et al., 2020), we are not aware of prior
signs over the space-time volume and empirically evaluate
                                                                 video recognition architectures using self-attention as the
them over large-scale action classification datasets. Among
                                                                 exclusive building block. However, we note that Trans-
the proposed schemes, we found that the best design is repre-
                                                                 formers have been adopted on top of convolutional feature
sented by a “divided attention” architecture which separately
                                                                 maps for action localization and recognition (Girdhar et al.,
applies temporal attention and spatial attention within each
                                                                 2019), video classification (Wang et al., 2018b; Chen et al.,
block of the network. Compared to the established paradigm
                                                                 2018b), and group activity recognition (Gavrilyuk et al.,
of convolution-based video architecture, TimeSformer fol-
                                                                 2020). We also note that there is a wide literature based on
lows a radically different design. Yet, it achieves accuracy
                                                                 the use of text Transformers combined with video CNNs
comparable, and in some cases superior, to the state-of-the-
                                                                 to address various video-language tasks, such as caption-
art in this field. We also show that our model can be used
                                                                 ing (Zhou et al., 2018), question-answering (Yang et al.,
for long-range modeling of videos spanning many minutes.
                                                                 2020) and dialog (Le et al., 2019). Finally, multimodal
                                                                 video-text transformers (Sun et al., 2019; Li et al., 2020a)
2. Related Work                                                  have also been trained or pretrained in unsupervised fashion
                                                                 by adopting masked-token pretext tasks adapted from the
Our approach is influenced by recent works that use self-
                                                                 language domain (Devlin et al., 2018; Radford et al., 2018).
attention for image classification, either in combination with
the convolution operator or even as a full replacement for it.
Within the former class, Non-Local Networks (Wang et al.,        3. The TimeSformer Model
2018b) employ a non-local mean that effectively generalizes
                                                                 Input clip. The TimeSformer takes as input a clip X ∈
the self-attention function of Transformers (Vaswani et al.,
                                                                 RH×W ×3×F consisting of F RGB frames of size H × W
2017b). Bello et al. (Bello et al., 2019) propose a 2D self-
                                                                 sampled from the original video.
attention mechanism that is competitive as a replacement of
2D convolution but gives even stronger results when used to      Decomposition into patches. Following the ViT (Doso-
augment convolutional features with self-attention features.     vitskiy et al., 2020), we decompose each frame into N
Beyond image categorization, Relation Networks (Hu et al.,       non-overlapping patches, each of size P × P , such that
2018) and DETR (Carion et al., 2020) use self-attention on       the N patches span the entire frame, i.e., N = HW/P 2 .
                                                                                                                   2
top of convolutional feature maps for object detection.          We flatten these patches into vectors x(p,t) ∈ R3P with
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Is Space-Time Attention All You Need for Video Understanding?

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       z(` 1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <latexit sha1_base64="PqFOkq34IvzyoSmk0/rjIYa/Lb0=">AAAB+3icbVBNS8NAEN3Ur1q/Yj16WSxCPVgSEfRY9OKxgv2ANpbNdtIu3WzC7kasIX/FiwdFvPpHvPlv3LY5aOuDgcd7M8zM82POlHacb6uwsrq2vlHcLG1t7+zu2fvllooSSaFJIx7Jjk8UcCagqZnm0IklkNDn0PbH11O//QBSsUjc6UkMXkiGggWMEm2kvl1Oe36An7L7tNoDzk/dk6xvV5yaMwNeJm5OKihHo29/9QYRTUIQmnKiVNd1Yu2lRGpGOWSlXqIgJnRMhtA1VJAQlJfObs/wsVEGOIikKaHxTP09kZJQqUnom86Q6JFa9Kbif1430cGllzIRJxoEnS8KEo51hKdB4AGTQDWfGEKoZOZWTEdEEqpNXCUTgrv48jJpndVcp+benlfqV3kcRXSIjlAVuegC1dENaqAmougRPaNX9GZl1ov1bn3MWwtWPnOA/sD6/AHtlpOz</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Time Att.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 z(` 1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <latexit sha1_base64="PqFOkq34IvzyoSmk0/rjIYa/Lb0=">AAAB+3icbVBNS8NAEN3Ur1q/Yj16WSxCPVgSEfRY9OKxgv2ANpbNdtIu3WzC7kasIX/FiwdFvPpHvPlv3LY5aOuDgcd7M8zM82POlHacb6uwsrq2vlHcLG1t7+zu2fvllooSSaFJIx7Jjk8UcCagqZnm0IklkNDn0PbH11O//QBSsUjc6UkMXkiGggWMEm2kvl1Oe36An7L7tNoDzk/dk6xvV5yaMwNeJm5OKihHo29/9QYRTUIQmnKiVNd1Yu2lRGpGOWSlXqIgJnRMhtA1VJAQlJfObs/wsVEGOIikKaHxTP09kZJQqUnom86Q6JFa9Kbif1430cGllzIRJxoEnS8KEo51hKdB4AGTQDWfGEKoZOZWTEdEEqpNXCUTgrv48jJpndVcp+benlfqV3kcRXSIjlAVuegC1dENaqAmougRPaNX9GZl1ov1bn3MWwtWPnOA/sD6/AHtlpOz</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               z(` 1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <latexit sha1_base64="PqFOkq34IvzyoSmk0/rjIYa/Lb0=">AAAB+3icbVBNS8NAEN3Ur1q/Yj16WSxCPVgSEfRY9OKxgv2ANpbNdtIu3WzC7kasIX/FiwdFvPpHvPlv3LY5aOuDgcd7M8zM82POlHacb6uwsrq2vlHcLG1t7+zu2fvllooSSaFJIx7Jjk8UcCagqZnm0IklkNDn0PbH11O//QBSsUjc6UkMXkiGggWMEm2kvl1Oe36An7L7tNoDzk/dk6xvV5yaMwNeJm5OKihHo29/9QYRTUIQmnKiVNd1Yu2lRGpGOWSlXqIgJnRMhtA1VJAQlJfObs/wsVEGOIikKaHxTP09kZJQqUnom86Q6JFa9Kbif1430cGllzIRJxoEnS8KEo51hKdB4AGTQDWfGEKoZOZWTEdEEqpNXCUTgrv48jJpndVcp+benlfqV3kcRXSIjlAVuegC1dENaqAmougRPaNX9GZl1ov1bn3MWwtWPnOA/sD6/AHtlpOz</latexit>




                      z(` 1)
                      <latexit sha1_base64="PqFOkq34IvzyoSmk0/rjIYa/Lb0=">AAAB+3icbVBNS8NAEN3Ur1q/Yj16WSxCPVgSEfRY9OKxgv2ANpbNdtIu3WzC7kasIX/FiwdFvPpHvPlv3LY5aOuDgcd7M8zM82POlHacb6uwsrq2vlHcLG1t7+zu2fvllooSSaFJIx7Jjk8UcCagqZnm0IklkNDn0PbH11O//QBSsUjc6UkMXkiGggWMEm2kvl1Oe36An7L7tNoDzk/dk6xvV5yaMwNeJm5OKihHo29/9QYRTUIQmnKiVNd1Yu2lRGpGOWSlXqIgJnRMhtA1VJAQlJfObs/wsVEGOIikKaHxTP09kZJQqUnom86Q6JFa9Kbif1430cGllzIRJxoEnS8KEo51hKdB4AGTQDWfGEKoZOZWTEdEEqpNXCUTgrv48jJpndVcp+benlfqV3kcRXSIjlAVuegC1dENaqAmougRPaNX9GZl1ov1bn3MWwtWPnOA/sD6/AHtlpOz</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           z(` 1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           <latexit sha1_base64="PqFOkq34IvzyoSmk0/rjIYa/Lb0=">AAAB+3icbVBNS8NAEN3Ur1q/Yj16WSxCPVgSEfRY9OKxgv2ANpbNdtIu3WzC7kasIX/FiwdFvPpHvPlv3LY5aOuDgcd7M8zM82POlHacb6uwsrq2vlHcLG1t7+zu2fvllooSSaFJIx7Jjk8UcCagqZnm0IklkNDn0PbH11O//QBSsUjc6UkMXkiGggWMEm2kvl1Oe36An7L7tNoDzk/dk6xvV5yaMwNeJm5OKihHo29/9QYRTUIQmnKiVNd1Yu2lRGpGOWSlXqIgJnRMhtA1VJAQlJfObs/wsVEGOIikKaHxTP09kZJQqUnom86Q6JFa9Kbif1430cGllzIRJxoEnS8KEo51hKdB4AGTQDWfGEKoZOZWTEdEEqpNXCUTgrv48jJpndVcp+benlfqV3kcRXSIjlAVuegC1dENaqAmougRPaNX9GZl1ov1bn3MWwtWPnOA/sD6/AHtlpOz</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Time Att.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Local Att.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                  Space Att.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Joint Space-Time Att.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Width Att.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Space Att.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Global Att.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       MLP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  MLP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Height Att.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  MLP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           MLP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        MLP
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       z(`)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <latexit sha1_base64="vr9M27hwkmJn9HyewcyBFvyrmCg=">AAAB+XicbVBNS8NAEN3Ur1q/oh69LBahXkoigh6LXjxWsB/QxLLZTtqlm03Y3RRqyD/x4kERr/4Tb/4bt20O2vpg4PHeDDPzgoQzpR3n2yqtrW9sbpW3Kzu7e/sH9uFRW8WppNCiMY9lNyAKOBPQ0kxz6CYSSBRw6ATj25nfmYBULBYPepqAH5GhYCGjRBupb9uZF4T4KX/Mah5wfp737apTd+bAq8QtSBUVaPbtL28Q0zQCoSknSvVcJ9F+RqRmlENe8VIFCaFjMoSeoYJEoPxsfnmOz4wywGEsTQmN5+rviYxESk2jwHRGRI/UsjcT//N6qQ6v/YyJJNUg6GJRmHKsYzyLAQ+YBKr51BBCJTO3YjoiklBtwqqYENzll1dJ+6LuOnX3/rLauCniKKMTdIpqyEVXqIHuUBO1EEUT9Ixe0ZuVWS/Wu/WxaC1Zxcwx+gPr8wcJUZNB</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            z(`)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <latexit sha1_base64="vr9M27hwkmJn9HyewcyBFvyrmCg=">AAAB+XicbVBNS8NAEN3Ur1q/oh69LBahXkoigh6LXjxWsB/QxLLZTtqlm03Y3RRqyD/x4kERr/4Tb/4bt20O2vpg4PHeDDPzgoQzpR3n2yqtrW9sbpW3Kzu7e/sH9uFRW8WppNCiMY9lNyAKOBPQ0kxz6CYSSBRw6ATj25nfmYBULBYPepqAH5GhYCGjRBupb9uZF4T4KX/Mah5wfp737apTd+bAq8QtSBUVaPbtL28Q0zQCoSknSvVcJ9F+RqRmlENe8VIFCaFjMoSeoYJEoPxsfnmOz4wywGEsTQmN5+rviYxESk2jwHRGRI/UsjcT//N6qQ6v/YyJJNUg6GJRmHKsYzyLAQ+YBKr51BBCJTO3YjoiklBtwqqYENzll1dJ+6LuOnX3/rLauCniKKMTdIpqyEVXqIHuUBO1EEUT9Ixe0ZuVWS/Wu/WxaC1Zxcwx+gPr8wcJUZNB</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  z(`)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <latexit sha1_base64="vr9M27hwkmJn9HyewcyBFvyrmCg=">AAAB+XicbVBNS8NAEN3Ur1q/oh69LBahXkoigh6LXjxWsB/QxLLZTtqlm03Y3RRqyD/x4kERr/4Tb/4bt20O2vpg4PHeDDPzgoQzpR3n2yqtrW9sbpW3Kzu7e/sH9uFRW8WppNCiMY9lNyAKOBPQ0kxz6CYSSBRw6ATj25nfmYBULBYPepqAH5GhYCGjRBupb9uZF4T4KX/Mah5wfp737apTd+bAq8QtSBUVaPbtL28Q0zQCoSknSvVcJ9F+RqRmlENe8VIFCaFjMoSeoYJEoPxsfnmOz4wywGEsTQmN5+rviYxESk2jwHRGRI/UsjcT//N6qQ6v/YyJJNUg6GJRmHKsYzyLAQ+YBKr51BBCJTO3YjoiklBtwqqYENzll1dJ+6LuOnX3/rLauCniKKMTdIpqyEVXqIHuUBO1EEUT9Ixe0ZuVWS/Wu/WxaC1Zxcwx+gPr8wcJUZNB</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                z(`)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <latexit sha1_base64="vr9M27hwkmJn9HyewcyBFvyrmCg=">AAAB+XicbVBNS8NAEN3Ur1q/oh69LBahXkoigh6LXjxWsB/QxLLZTtqlm03Y3RRqyD/x4kERr/4Tb/4bt20O2vpg4PHeDDPzgoQzpR3n2yqtrW9sbpW3Kzu7e/sH9uFRW8WppNCiMY9lNyAKOBPQ0kxz6CYSSBRw6ATj25nfmYBULBYPepqAH5GhYCGjRBupb9uZF4T4KX/Mah5wfp737apTd+bAq8QtSBUVaPbtL28Q0zQCoSknSvVcJ9F+RqRmlENe8VIFCaFjMoSeoYJEoPxsfnmOz4wywGEsTQmN5+rviYxESk2jwHRGRI/UsjcT//N6qQ6v/YyJJNUg6GJRmHKsYzyLAQ+YBKr51BBCJTO3YjoiklBtwqqYENzll1dJ+6LuOnX3/rLauCniKKMTdIpqyEVXqIHuUBO1EEUT9Ixe0ZuVWS/Wu/WxaC1Zxcwx+gPr8wcJUZNB</latexit>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     <latexit sha1_base64="N4ztu7rA6GcWPA6nADZ8tMOcvqE=">AAAB7XicbVDLSgNBEOyNrxhfUY9eBoPgKeyKoMegF48RzAOSJcxOZpMxszPLTK8QQv7BiwdFvPo/3vwbJ8keNLGgoajqprsrSqWw6PvfXmFtfWNzq7hd2tnd2z8oHx41rc4M4w2mpTbtiFouheINFCh5OzWcJpHkrWh0O/NbT9xYodUDjlMeJnSgRCwYRSc1uzqVme2VK37Vn4OskiAnFchR75W/un3NsoQrZJJa2wn8FMMJNSiY5NNSN7M8pWxEB7zjqKIJt+Fkfu2UnDmlT2JtXCkkc/X3xIQm1o6TyHUmFId22ZuJ/3mdDOPrcCJUmiFXbLEoziRBTWavk74wnKEcO0KZEe5WwobUUIYuoJILIVh+eZU0L6qBXw3uLyu1mzyOIpzAKZxDAFdQgzuoQwMYPMIzvMKbp70X7937WLQWvHzmGP7A+/wBz/6PRQ==</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        z(`)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <latexit sha1_base64="vr9M27hwkmJn9HyewcyBFvyrmCg=">AAAB+XicbVBNS8NAEN3Ur1q/oh69LBahXkoigh6LXjxWsB/QxLLZTtqlm03Y3RRqyD/x4kERr/4Tb/4bt20O2vpg4PHeDDPzgoQzpR3n2yqtrW9sbpW3Kzu7e/sH9uFRW8WppNCiMY9lNyAKOBPQ0kxz6CYSSBRw6ATj25nfmYBULBYPepqAH5GhYCGjRBupb9uZF4T4KX/Mah5wfp737apTd+bAq8QtSBUVaPbtL28Q0zQCoSknSvVcJ9F+RqRmlENe8VIFCaFjMoSeoYJEoPxsfnmOz4wywGEsTQmN5+rviYxESk2jwHRGRI/UsjcT//N6qQ6v/YyJJNUg6GJRmHKsYzyLAQ+YBKr51BBCJTO3YjoiklBtwqqYENzll1dJ+6LuOnX3/rLauCniKKMTdIpqyEVXqIHuUBO1EEUT9Ixe0ZuVWS/Wu/WxaC1Zxcwx+gPr8wcJUZNB</latexit>




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Joint Space-Time                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Divided Space-Time                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Sparse Local Global                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Axial Attention
              Space Attention (S)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Attention (ST)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Attention (T+S)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Attention (L+G)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (T+W+H)


Figure 1. The video self-attention blocks that we investigate in this work. Each attention layer implements self-attention (Vaswani et al.,
2017b) on a specified spatiotemporal neighborhood of frame-level patches (see Figure 2 for a visualization of the neighborhoods). We use
residual connections to aggregate information from different attention layers within each block. A 1-hidden-layer MLP is applied at the
end of each block. The final model is constructed by repeatedly stacking these blocks on top of each other.


p = 1, . . . , N denoting spatial locations and t = 1, . . . , F                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                where LN() deno es LayerNorm (Ba e a 2016) a =
depicting an index over frames.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 1     A s an ndex over mu p e a en on heads and A
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                deno es he o a number of a en on heads The a en
Linear embedding. We linearly map each patch x(p,t) into
                      (0)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       d mens ona y for each a en on head s se o Dh = D/A
an embedding vector z(p,t) ∈ RD by means of a learnable
             D×3P 2
matrix E ∈ R        :                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Se f-attent on computat on Se f-a en on we gh s are
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                compu ed v a do -produc         The se f-a en on we gh s
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (` a)
                      z(p,t) = Ex(p,t) + epos
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (0)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             α (p t) ∈ RN F +1 for query pa ch (p t) are g ven by
                                          (p,t)



where epos          D
         (p,t) ∈ R represents a learnable positional embed-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (` a) >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          #
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (` a)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                q(p t)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (` a)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    n
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (` a)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            o
ding added to encode the spatiotemporal position of each                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         α (p t) = SM  √                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            k(0 0) k(p t ) p =1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                              (0)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               N
patch. The resulting sequence of embedding vectors z(p,t)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Dh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   t =1     F
for p = 1, . . . , N , and t = 1, . . . , F represents the input to                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (5)
the Transformer, and plays a role similar to the sequences of
embedded words that are fed to text Transformers in NLP.
As in the original BERT Transformer (Devlin et al., 2018),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      where SM deno es he sof max ac va on func on No e
we add in the first position of the sequence a special learn-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ha when a en on s compu ed over one d mens on on y
               (0)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (e g spa a -on y or empora -on y) he compu a on s
able vector z(0,0) ∈ RD representing the embedding of the
classification token.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           s gn fican y reduced For examp e n he case of spa a
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                a en on on y N + 1 query-key compar sons are made
Query-Key-Value computation. Our Transformer consists                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           us ng exc us ve y keys from he same frame as he query
of L encoding blocks. At each block `, a query/key/value
vector is computed for each patch from the representation
 (`−1)
z(p,t) encoded by he preced ng b ock                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (` a) >
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    q(p t)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      n       o                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (` a)space                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (` a)   (` a)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                α (p t)      = SM  √                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           k(0 0) k(p t)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      Dh
                                     
              (` a)             (`−1)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (` a)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         p =1       N
            q(p t) = WQ     LN z(p t) ∈ RDh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (2)
             (` a)    (` a)
                              
                                (`−1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (6)
            k(p t) = WK LN z(p t) ∈ RDh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (`)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Encod ng The encod ng z(p t) a b ock ` s ob a ned by
                                     
             (` a)    (` a)     (`−1)
            v(p t) = WV LN z(p t) ∈ RDh                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         (4)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                firs compu ng he we gh ed sum of va ue vec ors us ng
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                se f-a en on coeffic en s from each a en on head
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Is Space-Time Attention All You Need for Video Understanding?




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             <latexit sha1_base64="AU/vq+DAgMm1x9RhUc20aA7BJwY=">AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lE0GPRi8cK9gPaUDabTbt2kw27E6GE/gcvHhTx6v/x5r9x2+agrQ8GHu/NMDMvSKUw6LrfTmltfWNzq7xd2dnd2z+oHh61jco04y2mpNLdgBouRcJbKFDybqo5jQPJO8H4duZ3nrg2QiUPOEm5H9NhIiLBKFqp3Q+5RDqo1ty6OwdZJV5BalCgOah+9UPFspgnyCQ1pue5Kfo51SiY5NNKPzM8pWxMh7xnaUJjbvx8fu2UnFklJJHSthIkc/X3RE5jYyZxYDtjiiOz7M3E/7xehtG1n4skzZAnbLEoyiRBRWavk1BozlBOLKFMC3srYSOqKUMbUMWG4C2/vEraF3XPrXv3l7XGTRFHGU7gFM7BgytowB00oQUMHuEZXuHNUc6L8+58LFpLTjFzDH/gfP4AkYyPHA==</latexit>
                     frame t -
                     frame t<latexit sha1_base64="AU/vq+DAgMm1x9RhUc20aA7BJwY=">AAAB7XicbVBNS8NAEJ3Ur1q/qh69LBbBU0lE0GPRi8cK9gPaUDabTbt2kw27E6GE/gcvHhTx6v/x5r9x2+agrQ8GHu/NMDMvSKUw6LrfTmltfWNzq7xd2dnd2z+oHh61jco04y2mpNLdgBouRcJbKFDybqo5jQPJO8H4duZ3nrg2QiUPOEm5H9NhIiLBKFqp3Q+5RDqo1ty6OwdZJV5BalCgOah+9UPFspgnyCQ1pue5Kfo51SiY5NNKPzM8pWxMh7xnaUJjbvx8fu2UnFklJJHSthIkc/X3RE5jYyZxYDtjiiOz7M3E/7xehtG1n4skzZAnbLEoyiRBRWavk1BozlBOLKFMC3srYSOqKUMbUMWG4C2/vEraF3XPrXv3l7XGTRFHGU7gFM7BgytowB00oQUMHuEZXuHNUc6L8+58LFpLTjFzDH/gfP4AkYyPHA==</latexit>
                     frame t +




                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Joint Space-Time           Divided Space-Time   Sparse Local Global   Axial Attention
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Space Attention (S)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Attention (ST)             Attention (T+S)      Attention (L+G)       (T+W+H)

Figure 2. Visualization of the five space-time self-attention schemes studied in this work. Each video clip is viewed as a sequence of
frame-level patches with a size of 16 × 16 pixels. For illustration, we denote in blue the query patch and show in non-blue colors its
self-attention space-time neighborhood under each scheme. Patches without color are not used for the self-attention computation of the
blue patch. Multiple colors within a scheme denote attentions separately applied along different dimensions (e.g., space and time for
(T+S)) or over different neighborhoods (e.g., for (L+G)). Note that self-attention is computed for every single patch in the video clip, i.e.,
every patch serves as a query. We also note that although the attention pattern is shown for only two adjacent frames, it extends in the
same fashion to all frames of the clip.

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               dependencies across frames. As shown in our experiments,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            N X
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              F
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               this approach leads to degraded classification accuracy com-
  (`,a)      (`,a)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (`,a)                      (`,a)            (`,a)             pared to full spatiotemporal attention, especially on bench-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            X
 s(p,t) = α(p,t),(0,0) v(0,0) +                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           α(p,t),(p0 ,t0 ) v(p0 ,t0 ) .
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            p0 =1 t0 =1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               marks where strong temporal modeling is necessary.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (7)      We propose a more efficient architecture for spatiotemporal
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              attention, named “Divided Space-Time Attention” (denoted
Then, the concatenation of these vectors from all heads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       with T+S), where temporal attention and spatial attention
is projected and passed through an MLP, using residual                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        are separately applied one after the other. This architecture
connections after each operation:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             is compared to that of Space and Joint Space-Time attention
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              in Fig. 1. A visualization of the different attention models
                            (`,1)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            on a video example is given in Fig. 2. For Divided Attention,
                           s(p,t)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              within each block `, we first compute temporal attention by
             (`)
          z0 (p,t) = WO 
                             ..    + z(`−1)
                                   
                              .       (p,t)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (8)      comparing each patch (p, t) with all the patches at the same
                            (`,A)
                          s(p,t)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              spatial location in the other frames:
                                     
             (`)                   (`)        (`)
           z(p,t) = MLP LN z0 (p,t) + z0 (p,t) .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (9)                          (`,a) > 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 q(p,t)           n       o           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (`,a)time                  (`,a)   (`,a)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               α (p,t)     = SM √
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        · k(0,0) k(p,t0 ) 0           .
Classification embedding. The final clip embedding is                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Dh                      t =1,...,F

obtained from the final block for the classification token:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (11)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (`)time
                                   
                               (L)
                       y = LN z(0,0) ∈ RD .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (10)         The encoding z0 (p,t) resulting from the application of
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Eq. 8 using temporal attention is then fed back for spatial
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               attention computation instead of being passed to the MLP. In
On top of this representation we append a 1-hidden-layer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       other words, new key/query/value vectors are obtained from
MLP, which is used to predict the final video classes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (`)time
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               z0 (p,t) and spatial attention is then computed using Eq. 6.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (`)space
Space-Time Self-Attention Models. We can reduce the                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Finally, the resulting vector z0 (p,t)    is passed to the MLP
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (`)
computational cost by replacing the spatiotemporal atten-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      of Eq. 9 to compute the final encoding z(p,t) of the patch at
tion of Eq. 5 with spatial attention within each frame only                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    block `. For the model of divided attention, we learn dis-
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (`,a)     (`,a)    (`,a)
(Eq. 6). However, such a model neglects to capture temporal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    tinct query/key/value matrices {WQtime , WK time , WV time }
                                     Is Space-Time Attention All You Need for Video Understanding?

                 Attention         Params   K400   SSv2                          3                                            10
                                                                                       Joint Space-Time                                Joint Space-Time
                   Space           85.9M    76.9   36.6                                Divided Space-Time                              Divided Space-Time
             Joint Space-Time       85.9M   77.4   58.5




                                                                        TFLOPs




                                                                                                                     TFLOPs
                                                                                 2            Out of memory
            Divided Space-Time     121.4M   78.0   59.5                                                                                    Out of memory
            Sparse Local Global    121.4M   75.9   56.3                                                                        5
                   Axial           156.8M   73.5   56.2                          1

Table 1. Video-level accuracy for different space-time attention                 0                                             0
schemes in TimeSformer. We evaluate the models on the valida-                        224     336        448    560                 8         32            64   96
                                                                                           Spatial Crop (Px)                              # of Input frames
tion sets of Kinetics-400 (K400), and Something-Something-V2
(SSv2). We observe that divided space-time attention achieves the    Figure 3. We compare the video classification cost (in TFLOPs) of
best results on both datasets.                                       Joint Space-Time versus Divided Space-Time attention. We plot
                                                                     the number of TFLOPs as a function of spatial crop size in pixels
         (`,a)      (`,a)         (`,a)                              (left), and the number of input frames (right). As we increase the
and {WQspace , WK space , WV space } over the time and space         spatial resolution (left), or the video length (right), our proposed di-
dimensions. Note that compared to the (N F + 1) compar-              vided space-time attention leads to dramatic computational savings
isons per patch needed by the joint spatiotemporal attention         compared to the scheme of joint space-time attention.
model of Eq. 5, Divided Attention performs only (N +F +2)
comparisons per patch. Our experiments demonstrate that
this space-time factorization is not only more efficient but it      4.1. Analysis of Self-Attention Schemes
also leads to improved classification accuracy.
                                                                     For this first set of experiments we start from a ViT pre-
We have also experimented with a “Sparse Local Global”               trained on ImageNet-21K. In Table 1, we present the results
(L+G) and an “Axial” (T+W+H) attention models. Their                 obtained with TimeSformer for the five proposed space-time
architectures are illustrated in Fig. 1, while Fig. 2 shows          attention schemes on Kinetics-400 (K400) and Something-
the patches considered for attention by these models. For            Something-V2 (SSv2). First, we note that TimeSformer
each patch (p, t), (L+G) first computes a local attention by         with space-only attention (S) performs well on K400. This
considering the neighboring F × H/2 × W/2 patches and                is an interesting finding. Indeed, prior work (Sevilla-Lara
then calculates a sparse global attention over the entire clip       et al., 2021) has shown that on K400, spatial cues are more
using a stride of 2 patches along the temporal dimension and         important than temporal information in order to achieve
also the two spatial dimensions. Thus, it can be viewed as a         strong accuracy. Here, we show that it is possible to obtain
faster approximation of full spatiotemporal attention using a        solid accuracy on K400 without any temporal modeling.
local-global decomposition and a sparsity pattern, similar to        Note, however, that space-only attention performs poorly on
that used in (Child et al., 2019). Finally, “Axial” attention        SSv2. This stresses the importance of temporal modeling
decomposes the attention computation in three distinct steps:        on this latter dataset.
over time, width and height. A decomposed attention over
                                                                     Furthermore, we observe that divided space-time attention
the two spatial axes of the image was proposed in (Ho
                                                                     achieves the best accuracy on both K400 and SSv2. This
et al., 2019; Huang et al., 2019; Wang et al., 2020b) and
                                                                     makes sense because compared to joint space-time attention,
our (T+W+H) adds a third dimension (time) for the case
                                                                     divided space-time attention has a larger learning capacity
of video. All these models are implemented by learning
                                                                     (see Table 1) as it contains distinct learning parameters for
distinct query/key/value matrices for each attention step.
                                                                     temporal attention and spatial attention.

4. Experiments                                                       In Figure 3, we also compare the computational cost of joint
                                                                     space-time versus divided space-time attention when using
We evaluate TimeSformer on four popular action recogni-              higher spatial resolution (left) and longer (right) videos. We
tion datasets: Kinetics-400 (Carreira & Zisserman, 2017),            note that the scheme of divided space-time scales gracefully
Kinetics-600 (Carreira et al., 2018), Something-Something-           under both of these settings. In contrast, the scheme of
V2 (Goyal et al., 2017b), and Diving-48 (Li et al., 2018). We        joint space-time attention leads to a dramatically higher cost
adopt the “Base” ViT architecture (Dosovitskiy et al., 2020)         when resolution or video length is increased. In practice,
pretrained on either ImageNet-1K or ImageNet-21K (Deng               joint space-time attention causes a GPU memory overflow
et al., 2009), as specified for each experiment. Unless dif-         once the spatial frame resolution reaches 448 pixels, or once
ferently indicated, we use clips of size 8 × 224 × 224, with         the number of frames is increased to 32 and thus it is effec-
frames sampled at a rate of 1/32. The patch size is 16 × 16          tively not applicable to large frames or long videos. Thus,
pixels. During inference, unless otherwise noted, we sam-            despite a larger number of parameters, divided space-time
ple a single temporal clip in the middle of the video. We            attention is more efficient than joint space-time attention
use 3 spatial crops (top-left, center, bottom-right) from the        when operating on higher spatial resolution, or longer videos.
temporal clip and obtain the final prediction by averaging           Thus, for all subsequent experiments we use a TimeSformer
the scores for these 3 crops.                                        constructed with divided space-time self-attention blocks.
                                  Is Space-Time Attention All You Need for Video Understanding?

    Model       Pretrain    K400 Training   K400   Inference   Params                 Method         Pretraining   K400   SSv2
                            Time (hours)    Acc.   TFLOPs                           TimeSformer     ImageNet-1K    75.8   59.5
 I3D 8x8 R50 ImageNet-1K        444         71.0      1.11     28.0M                TimeSformer    ImageNet-21K    78.0   59.5
 I3D 8x8 R50 ImageNet-1K       1440         73.4      1.11     28.0M              TimeSformer-HR    ImageNet-1K    77.8   62.2
 SlowFast R50 ImageNet-1K       448         70.0      1.97     34.6M              TimeSformer-HR   ImageNet-21K    79.7   62.5
 SlowFast R50 ImageNet-1K      3840         75.6      1.97     34.6M               TimeSformer-L    ImageNet-1K    78.1   62.4
 SlowFast R50     N/A          6336         76.4      1.97     34.6M               TimeSformer-L   ImageNet-21K    80.7   62.3
 TimeSformer ImageNet-1K        416         75.8      0.59     121.4M
 TimeSformer ImageNet-21K       416         78.0      0.59     121.4M   Table 3. Comparing the effectiveness of ImageNet-1K and
Table 2. Comparing TimeSformer to SlowFast and I3D. We ob-              ImageNet-21K pretraining on Kinetics-400 (K400) and Something-
serve that TimeSformer has lower inference cost despite having          Something-V2 (SSv2). On K400, ImageNet-21K pretraining leads
a larger number of parameters. Furthermore, the cost of training        consistently to a better performance compared to ImageNet-1K pre-
TimeSformer on video data is much lower compared to SlowFast            training. On SSv2, ImageNet-1K and ImageNet-21K pretrainings
and I3D, even when all models are pretrained on ImageNet-1K.            lead to similar accuracy.



4.2. Comparison to 3D CNNs                                              (i.e., 448 GPU hours), its accuracy drops to 70.0%. Simi-
                                                                        larly, training I3D using a similar computational budget (i.e.,
In this subsection we perform an empirical study aimed
                                                                        444 GPU hours) leads to a lower accuracy of 71.0%. This
at understanding the distinguishing properties of TimeS-
                                                                        highlights the fact that some of the latest 3D CNNs (Feicht-
former compared to 3D convolutional architectures, which
                                                                        enhofer et al., 2019b; Feichtenhofer, 2020) require a very
have been the prominent approach to video understanding
                                                                        long optimization schedule to achieve good performance
in recent years. We focus our comparison on two 3D CNN
                                                                        (even when using ImageNet pretraining). In contrast, TimeS-
models: 1) SlowFast (Feichtenhofer et al., 2019b), which is
                                                                        former provides a more efficient alternative to labs that do
the state-of-the-art in video classification, and 2) I3D (Car-
                                                                        not have access to hundreds of GPUs.
reira & Zisserman, 2017), which has been shown to benefit
from image-based pretraining, similarly to our own model.               The Importance of Pretraining. Due to a large number
We present quantitative comparisons to these two networks               of parameters, training our model from scratch is difficult.
in Table 2 and highlight key observations below.                        Thus, before training TimeSformer on video data, we ini-
                                                                        tialize it with weights learned from ImageNet. In contrast,
Model Capacity. From Table 2, we first observe that al-
                                                                        SlowFast can be learned on video data from scratch although
though TimeSformer has a large learning capacity (the num-
                                                                        at the expense of a very high training cost (see Table 2). We
ber of parameters is 121.4M ), it has low inference cost
                                                                        also attempted to train TimeSformer on Kinetics-400 di-
(0.59 in TFLOPs). In contrast, SlowFast 8x8 R50 has a
                                                                        rectly, without any ImageNet pretraining. By using a longer
larger inference cost (1.97 TFLOPs) despite containing only
                                                                        training schedule and more data augmentations, we found
34.6M parameters. Similarly, I3D 8x8 R50 also has a larger
                                                                        it possible to train the model from scratch, albeit to a much
inference cost (1.11 TFLOPs) despite containing fewer pa-
                                                                        lower video level accuracy of 64.8%. Thus, based on these
rameters (28.0M ). This suggests that TimeSformer is better
                                                                        results, for all subsequent studies we continued to use Ima-
suited for settings that involve large-scale learning. In con-
                                                                        geNet for pretraining (Deng et al., 2009)
trast, the large computational cost of modern 3D CNNs
makes it difficult to further increase their model capacity             In Table 3 we study the benefits of ImageNet-1K vs
while also maintaining efficiency.                                      ImageNet-21K pretraining on K400 and SSv2. For these
                                                                        experiments, we use three variants of our model: (1) TimeS-
Video Training Time. One significant advantage of Ima-
                                                                        former, which is the default version of our model operating
geNet pretraining is that it enables very efficient training of
                                                                        on 8 × 224 × 224 video clips, (2) TimeSformer-HR, a high
TimeSformer on video data. Conversely, state-of-the-art 3D
                                                                        spatial resolution variant that operates on 16 × 448 × 448
CNNs are much more expensive to train even if pretrained
                                                                        video clips, and lastly (3) TimeSformer-L, a long-range
on image datasets. In Table 2, we compare the video train-
                                                                        configuration of our model that operates on 96 × 224 × 224
ing time on Kinetics-400 (in Tesla V100 GPU hours) of
                                                                        video clips with frames sampled at a rate of 1/4.
TimeSformer to that of SlowFast and I3D. Starting from a
ResNet50 pretrained on ImageNet-1K, SlowFast 8 × 8 R50                  Based on the results in Table 3, we observe that ImageNet-
requires 3 840 Tesla V100 GPU hours in order to reach an                21K pretraining is beneficial for K400, where it leads to
accuracy of 75.6% on Kinetics-400. Training I3D, under                  a consistently higher accuracy compared to ImageNet-1K
similar settings, requires 1 440 Tesla V100 GPU hours for a             pretraining. On the other hand, on SSv2, we observe that
73.4% accuracy. In contrast, TimeSformer, also pretrained               ImageNet-1K and ImageNet-21K pretrainings lead to simi-
on ImageNet-1K, only requires 416 Tesla V100 GPU hours                  lar accuracy. This makes sense as SSv2 requires complex
to achieve a higher 75.8% accuracy (see Table 2). Fur-                  spatiotemporal reasoning, whereas K400 is biased more to-
thermore, if we constrain SlowFast to be trained under a                wards spatial scene information, and thus, it benefits more
somewhat similar computational budget as TimeSformer                    from the features learned on the larger pretraining dataset.
                                                      Is Space-Time Attention All You Need for Video Understanding?

                             Kinetics                                   Something-Something-V2                              80                                                  80
                                                                 60




                                                                                                            Clip Accuracy




                                                                                                                                                                Clip Accuracy
            75
                                                                 55                                                         75                                                  75




                                                      Accuracy
 Accuracy




            70                                                   50
                                                                                                                            70                                                  70
                                                                 45
            65                                                                                                              65
                                        TimeSformer              40                      TimeSformer                                                                            65
                                        SlowFast                                         SlowFast
                                        I3D                      35                      I3D                                     224   336     448     560                           8    32      64          96
            60
                                                                                                                                   Spatial Crop Side (Px)                            Number of Input Frames
                 60K     120K       180K       240K               42K      85K        127K       170K
                       # of Training Videos                               # of Training Videos
                                                                                                        Figure 5. Clip-level accuracy on Kinetics-400 as a function of spa-
Figure 4. Accuracy on Kinetics-400 (K400), and Something-
                                                                                                        tial crop size in pixels (left), and the number of input frames (right).
Something-V2 (SSv2) as a function of the number of training
videos. On K400, TimeSformer performs best in all cases. On
                                                                                                                                         Positional Embedding                   K400      SSv2
SSv2, which requires more complex temporal reasoning, TimeS-                                                                                     None                           75.4      45.8
former outperforms the other models only when using enough                                                                                     Space-only                       77.8      52.5
                                                                                                                                              Space-Time                        78.0      59.5
training videos. All models are pretrained on ImageNet-1K.
                                                                                                        Table 4. Ablation on positional embeddings. The version of TimeS-
The Impact of Video-Data Scale. To understand the                                                       former using space-time positional embeddings yields the highest
                                                                                                        accuracy on both Kinetics-400 and SSv2.
effects of video-data scale on performance, we trained
TimeSformer on different subsets of K400 and SSv2:
{25%, 50%, 75%, 100%} of the full datasets. We show                                                     4.4. The Importance of Positional Embeddings
these results in Figure 4, where we also compare our method                                             To investigate the importance of our learned spatiotempo-
with SlowFast R50 (Feichtenhofer et al., 2019b), and I3D                                                ral positional embeddings, we also conduct experiments
R50 (Carreira & Zisserman, 2017) trained on the same sub-                                               with a few variants of TimeSformer that use: (1) no po-
sets and using the same pretraining. Since we do not have                                               sitional embedding, (2) space-only positional embedding,
access to a ResNet pretrained on ImageNet-21K, we use                                                   and (3) space-time positional embedding. We report these
ImageNet-1K pretraining for all 3 architectures.                                                        results in Table 4. Based on these results, we observe
The results of Figure 4 show that, on K400, TimeSformer                                                 that the variant of our model that uses space-time posi-
outperforms the other models for all training subsets. How-                                             tional embeddings produces the best accuracy on both
ever, we observe a different trend on SSv2, where TimeS-                                                Kinetics-400, and Something-Something-V2. Interestingly,
former is the strongest model only when trained on 75% or                                               we also observe that using space-only positional embed-
100% of the full data. This may be explained by the fact that                                           dings leads to solid results on Kinetics-400, but much worse
compared to K400, SSv2 requires learning more complex                                                   results on Something-Something-V2. This makes sense as
temporal patterns, and thus more examples are needed by                                                 Kinetics-400 is more spatially biased, whereas Something-
TimeSformer to learn effectively those patterns.                                                        Something-V2 requires complex temporal reasoning.

4.3. Varying the Number of Tokens                                                                       4.5. Comparison to the State-of-the-Art

The scalability of our model allows it to operate at higher                                             Kinetics-400 & Kinetics-600. In Table 5 we present our
spatial resolution and on longer videos compared to most 3D                                             results on the validation set of K400. For these experiments,
CNNs. We note that both of these aspects affect the length of                                           we use TimeSformer pretrained on ImageNet-21K. In ad-
the sequence of tokens fed to the Transformer. Specifically,                                            dition to the accuracy metrics, we also include inference
increasing the spatial resolution results in a higher number                                            cost, given in TFLOPs. We note that whereas most previous
of patches (N ) per frame. The number of input tokens is
also increased when using more frames. To investigate the                                                                                  Method                   Top-1 Top-5 TFLOPs
benefits, we conduct an empirical study where we separately                                                                       R(2+1)D (Tran et al., 2018)        72.0 90.0   17.5
                                                                                                                                   bLVNet (Fan et al., 2019)         73.5 91.2   0.84
increase the number of tokens along each of these two axes.                                                                          TSM (Lin et al., 2019)          74.7 N/A    N/A
                                                                                                                                   S3D-G (Xie et al., 2018)          74.7 93.4   N/A
We report the findings in Figure 5. We see that increasing                                                                      Oct-I3D+NL (Chen et al., 2019)       75.7 N/A    0.84
                                                                                                                                   D3D (Stroud et al., 2020)         75.9 N/A    N/A
the spatial resolution (up to a certain point) leads to a boost                                                                  I3D+NL (Wang et al., 2018b)         77.7 93.3   10.8
in performance. Similarly, we observe that increasing the                                                                       ip-CSN-152 (Tran et al., 2019)       77.8 92.8    3.2
                                                                                                                                 CorrNet (Wang et al., 2020a)        79.2 N/A     6.7
length of the input clip leads to consistent accuracy gains.                                                                    LGD-3D-101 (Qiu et al., 2019)        79.4 94.4   N/A
Due to GPU memory constraints, we are not able to test                                                                       SlowFast (Feichtenhofer et al., 2019b) 79.8 93.9     7.0
                                                                                                                               X3D-XXL (Feichtenhofer, 2020)         80.4 94.6    5.8
our model on clips longer than 96 frames. Still, we would                                                                                TimeSformer                 78.0 93.7   0.59
like to point out that using clips of 96 frames is a significant                                                                       TimeSformer-HR                79.7 94.4   5.11
departure from current convolutional models, which are                                                                                  TimeSformer-L                80.7 94.7   7.14

typically limited to processing inputs of 8 − 32 frames.                                                                         Table 5. Video-level accuracy on Kinetics-400.
                                        Is Space-Time Attention All You Need for Video Understanding?

                       Method                         Top-1      Top-5                        Method                     SSv2   Diving-48∗∗
          I3D-R50+Cell (Wang et al., 2020c)            79.8       94.4          SlowFast (Feichtenhofer et al., 2019b)   61.7       77.6
            LGD-3D-101 (Qiu et al., 2019)              81.5       95.6                TSM (Lin et al., 2019)             63.4       N/A
         SlowFast (Feichtenhofer et al., 2019b)        81.8       95.1               STM (Jiang et al., 2019)            64.2       N/A
            X3D-XL (Feichtenhofer, 2020)               81.9       95.5              MSNet (Kwon et al., 2020)            64.7       N/A
                     TimeSformer                       79.1       94.4                TEA (Li et al., 2020b)             65.1       N/A
                   TimeSformer-HR                      81.8       95.8               bLVNet (Fan et al., 2019)           65.2       N/A
                    TimeSformer-L                      82.2       95.6                      TimeSformer                  59.5       74.9
                                                                                          TimeSformer-HR                 62.2       78.0
        Table 6. Video-level accuracy on Kinetics-600.                                     TimeSformer-L                 62.4       81.0

                                                                          Table 7. Video-level accuracy on Something-Something-V2 and
                        80                                                Diving-48. ∗∗ Due to an issue with Diving-48 labels used in pre-
                                                                          viously published results, we only compare our method with a
                                                                          reproduced SlowFast 16 × 8 R101 model. All models are pre-
             Accuracy




                        75
                                                                          tained on ImageNet-1K.

                        70
                                                  TimeSformer-L
                                                  TimeSformer
                                                                          about 12 seconds of a Kinetics video with a single clip.
                                                  SlowFast-R101+NL
                                                  X3D-XL
                        65                                                Something-Something-V2 & Diving-48. In Table 7, we
                             1   3       5                           10
                                 # of Testing Clips                       also validate our model on SSv2 and Diving-48. Since
                                                                          ImageNet-21K pretraining does not improve accuracy on
Figure 6. Video-level accuracy on Kinetics-400 vs the number of
                                                                          SSv2 (see Table 3), in this case, we use TimeSformer pre-
temporal clips used during inference. TimeSformer-L achieves
excellent accuracy using a small number of clips, which leads to
                                                                          trained on ImageNet-1K. This also allows us to apply the
strong performance at low inference cost.                                 same pretraining to all other models in this comparison,
                                                                          using a ResNet pretrained on ImageNet-1K. Our results sug-
                                                                          gest that TimeSformer achieves lower accuracy than the best
methods use 10 temporal clips with 3 spatial crops (for a to-             models on this dataset. However, considering that our model
tal of 30 space-time views) during inference, TimeSformer                 uses a completely different design, we take these results as
achieves solid accuracy with only 3 views (3 spatial crops),              suggesting that TimesSformer is a promising approach even
which reduces the inference cost. Our long-range variant,                 for challenging temporally-heavy datasets, such as SSv2.
TimeSformer-L achieves a top-1 accuracy of 80.7%. Fur-                    In Table 7, we also present our method on another
thermore, our default TimeSformer has the lowest inference                “temporally-heavy” dataset, Diving-48. Due to a recently
cost among recent state-of-the-art models. Yet, it still pro-             discovered issue with a previous version of Diving-48 labels,
vides a solid accuracy of 78.0%, outperforming many more                  here, we only compare our method with a reproduced Slow-
costly models.                                                            Fast 16×8 R101 model. Our results show that TimeSformer
We also measured the actual inference runtime on 20K vali-                outperforms SlowFast by a substantial margin.
dation videos of Kinetics-400 (using 8 Tesla V100 GPUs).
Whereas SlowFast takes 14.88 hours to complete the infer-                 4.6. Long-Term Video Modeling
ence, TimeSformer, TimeSformer-HR, and TimeSformer-L
                                                                          Lastly, we evaluate TimeSformer on the task of long-term
take 36 minutes, 1.06 hours and 2.6 hours, respectively.
                                                                          video modeling using HowTo100M (Miech et al., 2019).
Thus, even though SlowFast and TimeSformer-L have com-
                                                                          HowTo100M is an instructional video dataset that contains
parable cost in terms of TFLOPs, in practice the runtimes
                                                                          around 1M instructional Web videos showing humans per-
of all our versions of TimeSformer are much lower.
                                                                          forming over 23K different tasks, such as cooking, repairing,
In Table 6, we also present our results on Kinetics-600.                  making arts, etc. The average duration of these videos is
Just like on Kinetics-400, we observe that TimeSformer                    around 7 minutes, which is orders of magnitude longer than
performs well on this benchmark, outperforming all prior                  the duration of videos in standard action recognition bench-
methods.                                                                  marks. Each HowTo100M video has a label indicating the
                                                                          task demonstrated in the video (one out of the 23K classes),
Finally, in Figure 6, we study the effect of using multi-
                                                                          which can be used for supervised training. Thus, it is a good
ple temporal clips during inference (each with a single
                                                                          benchmark to assess the ability of a model to recognize
spatial crop). We plot accuracy using K ∈ {1, 3, 5, 10}
                                                                          activities exhibited over very long temporal extents.
temporal clips for testing. We compare our model against
X3D (Feichtenhofer, 2020), and SlowFast (Feichtenhofer                    For this evaluation, we consider only categories that have
et al., 2019b). X3D and SlowFast require multiple (≥ 5)                   at least 100 video examples. This gives a subset of
clips to approach their top accuracy. Conversely, our long-               HowTo100M corresponding to 120K videos spanning 1059
range variant, TimeSformer-L, does not require multiple                   task categories. We randomly partition this collection into
clips to achieve its best performance, since it is able to span           85K training videos and 35K testing videos.
                                  Is Space-Time Attention All You Need for Video Understanding?

         Method      # Input   Single Clip   # Test   Top-1
                     Frames     Coverage     Clips     Acc
         SlowFast        8         8.5s        48      48.2
         SlowFast       32        34.1s        12      50.8
         SlowFast       64        68.3s         6      51.5
         SlowFast       96       102.4s         4      51.2
       TimeSformer       8         8.5s        48      56.8
       TimeSformer      32        34.1s        12      61.2
       TimeSformer      64        68.3s         6      62.2
       TimeSformer      96       102.4s         4      62.6

Table 8. Long-term task classification on HowTo100M. Given a           Figure 7. Visualization of space-time attention from the output
video spanning several minutes, the goal is to predict the long-term   token to the input space on Something-Something-V2. Our model
task demonstrated in the video (e.g., cooking breakfast, cleaning      learns to focus on the relevant parts in the video in order to perform
house, etc). We evaluate a few variants of SlowFast and TimeS-         spatiotemporal reasoning.
former on this task. “Single Clip Coverage” denotes the number
of seconds spanned by a single clip. “# Test Clips” is the average
number of clips needed to cover the entire video during inference.      60
                                                                                                                50                                      50


                                                                                                                40                                      40


All models in this comparison are pretrained on Kinetics-400.           40
                                                                                                                30                                      30


                                                                                                                20                                      20
                                                                        20

                                                                                                                10                                      10


                                                                         0                                                                                0
                                                                                                                    0

                                                                                                                                                        -10
                                                                                                               -10
                                                                       -20
                                                                                                                                                        -20


We present our results in Table 8. As our baselines, we use            -40
                                                                                                               -20


                                                                                                               -30
                                                                                                                                                        -30


                                                                                                                                                        -40
                                                                                                               -40


four variants of SlowFast R101, all operating on video clips           -60
                                                                                                                                                        -50




                                                                                                                                 TimeSformer                   TimeSformer w/ Divided
                                                                             -60   -40   -20    0    20   40   60       -60   -40   -20   0   20   40         -50   -40   -30   -20   -10   0   10   20   30   40   50




sampled at a frame rate of 1/32 but having varying number                                      ViT
                                                                                                                               w/ Space Attention                Space-Time Attention
of frames: 8, 32, 64 and 96. We use the same four config-
                                                                       Figure 8. Feature visualization with t-SNE (van der Maaten & Hin-
urations for TimeSformer, starting from a ViT pretrained
                                                                       ton, 2008) on Something-Something-V2. Each video is visualized
on ImageNet-21K. All models in this comparison are pre-                as a point. Videos belonging to the same action category have the
trained on Kinetics-400 before finetuning on HowTo100M.                same color. The TimeSformer with divided space-time attention
During inference, for each method, we sample as many                   learns semantically more separable features than the TimeSformer
non-overlapping temporal clips as needed to cover the full             with space-only attention or ViT (Dosovitskiy et al., 2020).
temporal extent of a video, e.g., if a single clip spans 8.5
seconds, we would sample 48 test clips to cover a video of
410 seconds. Video-level classification is done by averaging
the clip predictions.                                                  worse on both Kinetics-400, and Something-Something-V2.
                                                                       Given that our “Base” model already has 121M parameters,
From the results in Table 8 we first note that, for the same           we suspect that the current datasets are not big enough to
single clip coverage, TimeSformer outperforms the corre-               justify a further increase in model capacity. We also tried
sponding SlowFast by a large margin of 8 − 11%. We also                the “Small” ViT variant, which produced accuracies about
observe that longer-range TimeSformers do better, i.e., our            5% worse than our default “Base” ViT model.
longest-range variant achieves the best video-level classifica-
tion accuracy. These results suggest that our model is highly          Larger Patch Size. We also experimented with a different
suitable for tasks that require long-term video modeling.              patch size, i.e., P = 32. We report that this variant of our
                                                                       model produced results about 3% worse than our default
We also experimented with finetuning TimeSformer directly              variant using P = 16. We conjecture that the performance
from a ViT pretrained on ImageNet-1K and ImageNet-                     decrease with P = 32 is due to the reduced spatial granular-
21K (skipping the Kinetics-400 training). We report that               ity. We did not train any models with P values lower than
when pretrained only on ImageNet-1K, our model achieves                16 as those models have a much higher computational cost.
top-1 accuracies of 52.8, 58.4, 59.2, 59.4 for 8, 32, 64, 96
frame inputs, respectively. When considering ImagNet-                  The Order of Space and Time Self-Attention. Our pro-
21K pretraining, TimeSformer produces top-1 accuracies of              posed “Divided Space-Time Attention” scheme applies tem-
56.0, 59.2, 60.2, 62.1 for 8, 32, 64, 96 frame inputs, respec-         poral attention and spatial attention one after the other. Here,
tively. These results demonstrate that our model can effec-            we investigate whether reversing the order of time-space
tively exploit long-range temporal dependencies regardless             attention (i.e., applying spatial attention first, then tempo-
of the pretraining dataset that we use.                                ral) has an impact on our results. We report that apply-
                                                                       ing spatial attention first, followed by temporal attention
                                                                       leads to a 0.5% drop in accuracy on both Kinetics-400, and
4.7. Additional Ablations
                                                                       Something-Something-V2. We also tried a parallel space-
Smaller & Larger Transformers. In addition to the “Base”               time self-attention. We report that it produces 0.4% lower
ViT model (Dosovitskiy et al., 2020), we also experimented             accuracy compared to our adopted “Divided Space-Time
with the “Large” ViT. We report that this yielded results 1%           Attention” scheme.
                               Is Space-Time Attention All You Need for Video Understanding?

4.8. Qualitative Results                                         sample clips from the full-length videos with a frame rate
                                                                 of 1/32. The batch size is set to 16. We train all our models
Visualizing Learned Space-Time Attention. In Figure 7,
                                                                 using synchronized SGD across 32 GPUs. The momentum
we present space-time attention visualizations obtained by
                                                                 is set to 0.9, while the weight decay is set to 0.0001.
applying TimeSformer on Something-Something-V2 videos.
To visualize the learned attention, we use the Attention         Unless otherwise noted, in our experiments we use the
Rollout scheme presented in (Abnar & Zuidema, 2020).             “Base” ViT model (Dosovitskiy et al., 2020). Temporal and
Our results suggest that TimeSformer learns to attend to the     spatial attention layers in each block are initialized with the
relevant regions in the video in order to perform complex        same weights, which are obtained from the corresponding
spatiotemporal reasoning. For example, we can observe that       attention layer in ViT.
the model focuses on the configuration of the hand when
                                                                 Inference. As discussed in the main draft, during inference
visible and the object-only when not visible.
                                                                 we sample a single temporal clip in the middle of the video.
Visualizing Learned Feature Embeddings. In Figure 8,             We scale the shorter spatial side of a video to 224 pixels (or
we also visualize the features learned by TimeSformer on         448 for TimeSformer-HR) and take 3 crops of size 224×224
Something-Something-V2. The visualization is done using          (448 × 448 for TimeSformer-HR) to cover a larger spatial
t-SNE (van der Maaten & Hinton, 2008) where each point           extent within the clip. The final prediction is obtained by
represents a single video, and different colors depict differ-   averaging the softmax scores of these 3 predictions.
ent action categories. Based on this illustration, we observe
                                                                 Other models in our comparison. To train I3D (Carreira
that TimeSformer with divided space-time attention learns
                                                                 & Zisserman, 2017), and SlowFast (Feichtenhofer et al.,
semantically more separable features than the TimeSformer
                                                                 2019b), we use the training protocols that were used in the
with space-only attention or ViT (Dosovitskiy et al., 2020).
                                                                 original papers. For I3D, we initialize it with a 2D ImageNet
                                                                 CNN, and then train it for 118 epochs with a base learning
5. Conclusion                                                    rate of 0.01, which is divided by 10 at epochs 44 and 88.
                                                                 We use synchronized SGD across 32 GPUs following the
In this work, we introduced TimeSformer, a fundamentally
                                                                 linear scaling recipe of Goyal et al. (2017a). We set the
different approach to video modeling compared to the es-
                                                                 momentum to 0.9, and weight decay to 0.0001. The batch
tablished paradigm of convolution-based video networks.
                                                                 size is set to 64. For the SlowFast model, when initialized
We showed that it is possible to design an effective, and
                                                                 from ImageNet weights, we use this same exact training
scalable video architecture built exclusively on space-time
                                                                 protocol. When training SlowFast from scratch, we use the
self-attention. Our method (1) is conceptually simple, (2)
                                                                 training protocol described by the authors (Feichtenhofer
achieves state-of-the-art results on major action recognition
                                                                 et al., 2019b). More specifically, in that case, the training
benchmarks, (3) has low training and inference cost, and (4)
                                                                 is done for 196 epochs with a cosine learning rate schedule,
can be applied to clips of over one minute, thus enabling
                                                                 and the initial learning rate is set to 0.1. We use a linear
long-term video modeling. In the future, we plan to ex-
                                                                 warm-up for the first 34 epochs starting with a learning rate
tend our method to other video analysis tasks such as action
                                                                 of 0.01. A dropout of 0.5 is used before the final classifica-
localization, video captioning and question-answering.
                                                                 tion layer. The momentum is set to 0.9, the weight decay is
                                                                 0.0001, and the batch size is set to 64. Just as before, we
Appendix                                                         adopt the linear scaling recipe (Goyal et al., 2017a).

A. Implementation Details                                        Datasets. Kinetics-400 (Carreira & Zisserman, 2017) con-
                                                                 sists of 240K training videos and 20K validation videos
Our TimeSformer implementation is built using PySlow-            that span 400 human action categories. Kinetics-600 (Car-
Fast (Fan et al., 2020) and pytorch-image-models (Wight-         reira et al., 2018) has 392K training videos and 30K vali-
man, 2019) packages. Below, we describe specific imple-          dation videos spanning 600 action categories. Something-
mentation details regarding the training and inference pro-      Something-V2 (Goyal et al., 2017b) contains 170K training
cedures of our model.                                            videos and 25K validation videos that span 174 action cate-
Training. We train our model for 15 epochs with an initial       gories. Lastly, Diving-48 (Li et al., 2018) has 16K training
learning rate of 0.005, which is divided by 10 at epochs         videos and 3K testing videos spanning 48 fine-grained div-
11, and 14. During training, we first resize the shorter         ing categories. For all of these datasets, we use standard
side of the video to a random value in [256, 320]. We then       classification accuracy as our main performance metric.
randomly sample a 224 × 224 crop from the resized video.
For our high-resolution model, TimeSformer-HR, we resize
the shorter side of the video to a random value in [448, 512],
and then randomly sample a 448 × 448 crop. We randomly
                               Is Space-Time Attention All You Need for Video Understanding?

References                                                          International Conference on Computer Vision (ICCV),
                                                                    October 2019.
Abnar, S. and Zuidema, W. Quantifying attention flow in
  transformers, 2020.                                             Child, R., Gray, S., Radford, A., and Sutskever, I. Gener-
                                                                    ating long sequences with sparse transformers. CoRR,
Ba, L. J., Kiros, J. R., and Hinton, G. E. Layer normalization.
                                                                    2019.
  CoRR, 2016.
                                                                  Cordonnier, J., Loukas, A., and Jaggi, M. On the relation-
Bello, I., Zoph, B., Le, Q., Vaswani, A., and Shlens, J.
                                                                    ship between self-attention and convolutional layers. In
  Attention augmented convolutional networks. In 2019
                                                                    8th International Conference on Learning Representa-
  IEEE/CVF International Conference on Computer Vision,
                                                                    tions, ICLR 2020, Addis Ababa, Ethiopia, April 26-30,
  ICCV, 2019.
                                                                    2020, 2020.
Bertasius, G. and Torresani, L. Classifying, segmenting, and
                                                                  Dai, Z., Yang, Z., Yang, Y., Carbonell, J., Le, Q., and
  tracking object instances in video with mask propagation.
                                                                    Salakhutdinov, R. Transformer-XL: Attentive language
  In The IEEE Conference on Computer Vision and Pattern
                                                                    models beyond a fixed-length context. In Proceedings of
  Recognition (CVPR), June 2020.
                                                                    the 57th Annual Meeting of the Association for Computa-
Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan,             tional Linguistics, 2019.
  J., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G.,
                                                                  Deng, J., Dong, W., Socher, R., Li, L., Kai Li, and Li Fei-Fei.
  Askell, A., Agarwal, S., Herbert-Voss, A., Krueger, G.,
                                                                    Imagenet: A large-scale hierarchical image database. In
  Henighan, T., Child, R., Ramesh, A., Ziegler, D. M., Wu,
                                                                    2009 IEEE Conference on Computer Vision and Pattern
  J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M.,
                                                                    Recognition, pp. 248–255, 2009. doi: 10.1109/CVPR.
  Gray, S., Chess, B., Clark, J., Berner, C., McCandlish,
                                                                    2009.5206848.
  S., Radford, A., Sutskever, I., and Amodei, D. Language
  models are few-shot learners. 2020.                             Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K. Bert:
                                                                    Pre-training of deep bidirectional transformers for lan-
Carion, N., Massa, F., Synnaeve, G., Usunier, N., Kirillov,         guage understanding. arXiv preprint arXiv:1810.04805,
  A., and Zagoruyko, S. End-to-end object detection with            2018.
  transformers. In European Conference Computer Vision
  (ECCV), 2020.                                                   Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K. BERT:
                                                                    Pre-training of deep bidirectional transformers for lan-
Carreira, J. and Zisserman, A. Quo vadis, action recogni-           guage understanding. In Proceedings of the 2019 Confer-
  tion? A new model and the kinetics dataset. In 2017 IEEE          ence of the North American Chapter of the Association
  Conference on Computer Vision and Pattern Recognition,            for Computational Linguistics: Human Language Tech-
  CVPR 2017, Honolulu, HI, USA, July 21-26, 2017, 2017.             nologies, Volume 1 (Long and Short Papers), 2019.
Carreira, J., Noland, E., Banki-Horvath, A., Hillier, C., and     Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn,
  Zisserman, A. A short note about kinetics-600. CoRR,              D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer,
  2018.                                                             M., Heigold, G., Gelly, S., Uszkoreit, J., and Houlsby, N.
Chen, M. X., Firat, O., Bapna, A., Johnson, M., Macherey,          An image is worth 16x16 words: Transformers for image
  W., Foster, G., Jones, L., Schuster, M., Shazeer, N., Par-        recognition at scale. CoRR, 2020.
  mar, N., Vaswani, A., Uszkoreit, J., Kaiser, L., Chen,          Fan, H., Li, Y., Xiong, B., Lo, W.-Y., and Feichten-
  Z., Wu, Y., and Hughes, M. The best of both worlds:               hofer, C. Pyslowfast. https://github.com/
  Combining recent advances in neural machine translation.          facebookresearch/slowfast, 2020.
  In Proceedings of the 56th Annual Meeting of the Asso-
  ciation for Computational Linguistics. Association for          Fan, Q., Chen, C.-F. R., Kuehne, H., Pistoia, M., and Cox,
  Computational Linguistics, 2018a.                                 D. More is less: Learning efficient video representations
                                                                    by big-little network and depthwise temporal aggregation.
Chen, Y., Kalantidis, Y., Li, J., Yan, S., and Feng, J. Aˆ2-        In Advances in Neural Information Processing Systems,
  nets: Double attention networks. In Advances in Neural            volume 32, 2019.
  Information Processing Systems 31, 2018b.
                                                                  Feichtenhofer, C. X3d: Expanding architectures for efficient
Chen, Y., Fan, H., Xu, B., Yan, Z., Kalantidis, Y., Rohrbach,       video recognition. CVPR, pp. 200–210, 2020.
  M., Yan, S., and Feng, J. Drop an octave: Reducing
  spatial redundancy in convolutional neural networks with        Feichtenhofer, C., Fan, H., Malik, J., and He, K. Slowfast
  octave convolution. In Proceedings of the IEEE/CVF                networks for video recognition. In Proceedings of the
                              Is Space-Time Attention All You Need for Video Understanding?

  IEEE/CVF International Conference on Computer Vision          Li, Y., Li, Y., and Vasconcelos, N. Resound: Towards action
  (ICCV), 2019a.                                                   recognition without representation bias. In The Euro-
                                                                   pean Conference on Computer Vision (ECCV), September
Feichtenhofer, C., Fan, H., Malik, J., and He, K. Slowfast         2018.
  networks for video recognition. In 2019 IEEE/CVF Inter-
  national Conference on Computer Vision, ICCV, 2019b.          Li, Y., Ji, B., Shi, X., Zhang, J., Kang, B., and Wang, L. Tea:
                                                                  Temporal excitation and aggregation for action recogni-
Gavrilyuk, K., Sanford, R., Javan, M., and Snoek, C. G. M.
                                                                   tion. In Proceedings of the IEEE/CVF Conference on
  Actor-transformers for group activity recognition. In 2020
                                                                  Computer Vision and Pattern Recognition (CVPR), June
  IEEE/CVF Conference on Computer Vision and Pattern
                                                                   2020b.
  Recognition, CVPR, 2020.

Girdhar, R., Carreira, J., Doersch, C., and Zisserman, A.       Lin, J., Gan, C., and Han, S. Tsm: Temporal shift module for
  Video action transformer network. In IEEE Conference on         efficient video understanding. In Proceedings of the IEEE
  Computer Vision and Pattern Recognition, CVPR, 2019.            International Conference on Computer Vision, 2019.

Goyal, P., Dollár, P., Girshick, R., Noordhuis, P.,             Miech, A., Zhukov, D., Alayrac, J.-B., Tapaswi, M., Laptev,
 Wesolowski, L., Kyrola, A., Tulloch, A., Jia, Y., and           I., and Sivic, J. HowTo100M: Learning a Text-Video Em-
  He, K. Accurate, large minibatch sgd: Training imagenet        bedding by Watching Hundred Million Narrated Video
  in 1 hour. arXiv preprint arXiv:1706.02677, 2017a.             Clips. In ICCV, 2019.

Goyal, R., Kahou, S. E., Michalski, V., Materzynska, J.,        Ott, M., Edunov, S., Grangier, D., and Auli, M. Scaling
 Westphal, S., Kim, H., Haenel, V., Fründ, I., Yianilos,          neural machine translation. In Proceedings of the Third
  P., Mueller-Freitag, M., Hoppe, F., Thurau, C., Bax, I.,        Conference on Machine Translation: Research Papers,
  and Memisevic, R. The "something something" video               2018.
  database for learning and evaluating visual common sense.
 CoRR, 2017b.                                                   Parmar, N., Vaswani, A., Uszkoreit, J., Kaiser, L., Shazeer,
                                                                  N., Ku, A., and Tran, D. Image transformer. In Dy, J. G.
Ho, J., Kalchbrenner, N., Weissenborn, D., and Salimans, T.       and Krause, A. (eds.), Proceedings of the 35th Interna-
  Axial attention in multidimensional transformers. CoRR,         tional Conference on Machine Learning, ICML, 2018.
  2019.
                                                                Qiu, Z., Yao, T., Ngo, C.-W., Tian, X., and Mei, T. Learn-
Hu, H., Gu, J., Zhang, Z., Dai, J., and Wei, Y. Relation net-     ing spatio-temporal representation with local and global
 works for object detection. In 2018 IEEE Conference on           diffusion. In CVPR, 2019.
 Computer Vision and Pattern Recognition, CVPR, 2018.
                                                                Radford, A., Narasimhan, K., Salimans, T., and Sutskever,
Huang, Z., Wang, X., Huang, L., Huang, C., Wei, Y., and           I. Improving language understanding by generative pre-
  Liu, W. Ccnet: Criss-cross attention for semantic seg-          training. 2018.
  mentation. 2019.
                                                                Radford, A., Wu, J., Child, R., Luan, D., Amodei, D., and
Jiang, B., Wang, M., Gan, W., Wu, W., and Yan, J. Stm:
                                                                  Sutskever, I. Language models are unsupervised multitask
   Spatiotemporal and motion encoding for action recog-
                                                                  learners. 2019.
   nition. In Proceedings of the IEEE/CVF International
   Conference on Computer Vision (ICCV), October 2019.          Ramachandran, P., Parmar, N., Vaswani, A., Bello, I., Lev-
Kwon, H., Kim, M., Kwak, S., and Cho, M. Motionsqueeze:           skaya, A., and Shlens, J. Stand-alone self-attention in
 Neural motion feature learning for video understanding.          vision models. In Advances in Neural Information Pro-
 In ECCV, 2020.                                                   cessing Systems, pp. 68–80, 2019.

Le, H., Sahoo, D., Chen, N., and Hoi, S. Multimodal trans-      Sevilla-Lara, L., Zha, S., Yan, Z., Goswami, V., Feiszli,
  former networks for end-to-end video-grounded dialogue          M., and Torresani, L. Only time can tell: Discovering
  systems. In Proceedings of the 57th Annual Meeting of           temporal data for temporal modeling. In Proceedings
  the Association for Computational Linguistics, 2019.            of the IEEE/CVF Winter Conference on Applications of
                                                                  Computer Vision (WACV), pp. 535–544, January 2021.
Li, L., Chen, Y.-C., Cheng, Y., Gan, Z., Yu, L., and
  Liu, J. Hero: Hierarchical encoder for video+ lan-            Simonyan, K. and Zisserman, A. Very deep convolutional
  guage omni-representation pre-training. arXiv preprint          networks for large-scale image recognition. In ICLR,
  arXiv:2005.00200, 2020a.                                        2015.
                              Is Space-Time Attention All You Need for Video Understanding?

Stroud, J., Ross, D., Sun, C., Deng, J., and Sukthankar, R.    Wang, X., Girshick, R. B., Gupta, A., and He, K. Non-local
  D3d: Distilled 3d networks for video action recognition.      neural networks. In 2018 IEEE Conference on Computer
  In Proceedings of the IEEE/CVF Winter Conference on           Vision and Pattern Recognition, CVPR 2018, Salt Lake
  Applications of Computer Vision (WACV), March 2020.           City, UT, USA, June 18-22, 2018, 2018b.

Sun, C., Myers, A., Vondrick, C., Murphy, K., and Schmid,      Wang, X., Xiong, X., Neumann, M., Piergiovanni, A. J.,
  C. Videobert: A joint model for video and language            Ryoo, M. S., Angelova, A., Kitani, K. M., and Hua, W.
  representation learning, 2019.                                Attentionnas: Spatiotemporal attention cell search for
                                                                video classification. In Computer Vision - ECCV 2020 -
Szegedy, C., Liu, W., Jia, Y., Sermanet, P., Reed, S.,          16th European Conference, Glasgow, UK, August 23-28,
  Anguelov, D., Erhan, D., Vanhoucke, V., and Rabinovich,       2020, Proceedings, Part VIII, 2020c.
  A. Going deeper with convolutions. In Computer Vision
  and Pattern Recognition (CVPR), 2015.                        Weissenborn, D., Täckström, O., and Uszkoreit, J. Scal-
                                                                ing autoregressive video models. In 8th International
Teed, Z. and Deng, J. RAFT: recurrent all-pairs field trans-    Conference on Learning Representations, ICLR, 2020.
   forms for optical flow. In Computer Vision - ECCV 2020
  - 16th European Conference, Glasgow, UK, August 23-28,       Wightman, R. Pytorch image models. https://github.
  2020, Proceedings, Part II, 2020.                             com/rwightman/pytorch-image-models,
                                                                2019.
Tran, D., Wang, H., Torresani, L., Ray, J., LeCun, Y., and
  Paluri, M. A closer look at spatiotemporal convolutions      Xie, S., Sun, C., Huang, J., Tu, Z., and Murphy, K.
  for action recognition. In 2018 IEEE Conference on             Rethinking spatiotemporal feature learning: Speed-
  Computer Vision and Pattern Recognition, Salt Lake City,       accuracy trade-offs in video classification. In Com-
  USA, 2018, 2018.                                               puter Vision - ECCV 2018 - 15th European Confer-
                                                                 ence, Munich, Germany, September 8-14, 2018, Pro-
Tran, D., Wang, H., Feiszli, M., and Torresani, L. Video         ceedings, Part XV, pp. 318–335, 2018. doi: 10.1007/
  classification with channel-separated convolutional net-       978-3-030-01267-0\_19. URL https://doi.org/
  works. ICCV, pp. 5551–5560, 2019.                              10.1007/978-3-030-01267-0_19.
van der Maaten, L. and Hinton, G. Visualizing data us-         Yang, Z., Garcia, N., Chu, C., Otani, M., Nakashima, Y., and
  ing t-SNE. Journal of Machine Learning Research, 9:            Takemura, H. Bert representations for video question an-
  2579–2605, 2008. URL http://www.jmlr.org/                      swering. In The IEEE Winter Conference on Applications
  papers/v9/vandermaaten08a.html.                                of Computer Vision, 2020.
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,    Zhao, H., Jia, J., and Koltun, V. Exploring self-attention
  L., Gomez, A. N., Kaiser, L. u., and Polosukhin, I. Atten-     for image recognition. In 2020 IEEE/CVF Conference on
  tion is all you need. In Advances in Neural Information        Computer Vision and Pattern Recognition, CVPR, 2020.
  Processing Systems, 2017a.
                                                               Zhou, L., Zhou, Y., Corso, J. J., Socher, R., and Xiong, C.
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones,      End-to-end dense video captioning with masked trans-
  L., Gomez, A. N., Kaiser, L. u., and Polosukhin, I. Atten-     former. In Proceedings of the IEEE Conference on Com-
  tion is all you need. In Advances in Neural Information        puter Vision and Pattern Recognition, 2018.
  Processing Systems 30. 2017b.

Wang, H., Tran, D., Torresani, L., and Feiszli, M. Video
 modeling with correlation networks. In Proceedings of
 the IEEE/CVF Conference on Computer Vision and Pat-
 tern Recognition (CVPR), June 2020a.

Wang, H., Zhu, Y., Green, B., Adam, H., Yuille, A. L., and
 Chen, L. Axial-deeplab: Stand-alone axial-attention for
 panoptic segmentation. In Computer Vision - ECCV 2020
 - 16th European Conference, 2020b.

Wang, X., Girshick, R., Gupta, A., and He, K. Non-local
 neural networks. In Proceedings of the IEEE Conference
 on Computer Vision and Pattern Recognition (CVPR),
 June 2018a.
